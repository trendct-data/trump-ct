{
    "collab_server" : "",
    "contents" : "---\ntitle: \"What it would take for Trump to win Connecticut\"\nauthor: \"Andrew Ba Tran\"\ndate: \"July 21, 2016\"\noutput: html_document\n---\n\nDonald Trump's campaign is under the impression that a majority of Connecticut could be persuaded to vote for him as President in November's general election.\n\nBased on a state poll last month from Quinnipiac University, 45 percent of voters would choose Clinton compared to 38 percent for Trump. That single digit lead coupled with Governor Dannel Malloy's low approval rating based on another Quinnipiac poll leads many to believe there is an opportunity for Trump.\n\n\"It’s in play because the citizens of Connecticut are tired of the same things the people of the country, the United States, are tired of, which is bad leadership.\" said Paul Manafort, Trump's campaign manager and New Britain native, during a breakfast for the state's delegation at the Republican National Convention on Tuesday.\n\n## President-Elect Donald Trump\n\nWhat would it take for Trump to win in Connecticut? \n\nTrend CT sought to envision scenarios based on voting patterns and demographics. Consider this a thought exercise.\n\n## If Bernie voters switched to Trump\n\nThis year's presidential primaries saw a [historic turn out](http://trendct.org/2016/06/07/official-numbers-show-historic-turnout-for-ct-presidential-primaries/) among Republicans.\n\nNearly half of all registered Republicans in Connecticut participated in the primary election. The next-highest participation rate was 43 percent in 1980, when President Ronald Reagan ran.\n\nIn all, that's about 213,000 Republican primary voters— of which 123,000 voted for Trump.\n\n**Thought exercise: Let's assume that the general election was limited to voters who participated in the primary election**\n\nBased on raw primary votes, Trump would have won 99 towns in Connecticut while Clinton would have won just 70. \n\n```{r libraries, warning=F, message=F, echo=F}\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(scales)\n\nlibrary(ggplot2)\nlibrary(ggalt)\n\nlibrary(stringr)\nlibrary(knitr)\nlibrary(rgdal)\nrequire(maptools)\nlibrary(extrafont)\n```\n\n```{r working_the_data}\n\n## Republicans\n\nrep_results <- read.csv(\"data/RepublicanPresidentialPreferencePrimary.csv\", stringsAsFactors=FALSE)\nrep_results <- rep_results %>%\n  group_by(Town.Name, Candidate.Name) %>%\n  summarise(votes=sum(Vote.Totals))\n\nrep_results$Candidate.Name <- gsub(\"Donald J. Trump\", \"trump_count\", rep_results$Candidate.Name)\nrep_results$Candidate.Name <- gsub(\"John R. Kasich\", \"kasich_count\", rep_results$Candidate.Name)\nrep_results$Candidate.Name <- gsub(\"Ben Carson\", \"others_count\", rep_results$Candidate.Name)\nrep_results$Candidate.Name <- gsub(\"Ted Cruz\", \"others_count\", rep_results$Candidate.Name)\nrep_results$Candidate.Name <- gsub(\"Uncommitted\", \"others_count\", rep_results$Candidate.Name)\n\nrep_results <- rep_results %>%\n  group_by(Town.Name, Candidate.Name) %>%\n  summarise(votes=sum(votes)) %>%\n  spread(Candidate.Name, votes)\n\nrep_results$vote_diff <- rep_results$trump_count - rep_results$kasich_count\nrep_results$total <- rep_results$trump_count + rep_results$kasich_count + rep_results$others_count\nrep_results$trump_per <- round(rep_results$trump_count/rep_results$total*100,1)\nrep_results$kasich_per <- round(rep_results$kasich_count/rep_results$total*100,1)\nrep_results$others_per <- round(rep_results$others_count/rep_results$total*100,1)\nrep_results$percent_diff <- rep_results$trump_per - rep_results$kasich_per\nnames(rep_results)[names(rep_results) == 'Town.Name'] <- 'Town'\nrep_results <- data.frame(rep_results)\n\n## Democrats\n\ndem_results_sos <- read.csv(\"data/DemocraticPresidentialPreferencePrimary.csv\", stringsAsFactors=FALSE)\ndem_results_sos <- dem_results_sos %>%\n  group_by(Town.Name, Candidate.Name) %>%\n  summarise(votes=sum(Vote.Totals))\n\ndem_results_sos$Candidate.Name <- gsub(\"Bernie Sanders\", \"sanders_count\", dem_results_sos$Candidate.Name)\ndem_results_sos$Candidate.Name <- gsub(\"Hillary Clinton\", \"clinton_count\", dem_results_sos$Candidate.Name)\ndem_results_sos$Candidate.Name <- gsub(\"Roque Rocky De La Fuente\", \"others_count\", dem_results_sos$Candidate.Name)\ndem_results_sos$Candidate.Name <- gsub(\"Uncommitted\", \"others_count\", dem_results_sos$Candidate.Name)\n\ndem_results_sos <- dem_results_sos %>%\n  group_by(Town.Name, Candidate.Name) %>%\n  summarise(votes=sum(votes)) %>%\n  spread(Candidate.Name, votes)\n\ndem_results_sos$vote_diff <- dem_results_sos$clinton_count - dem_results_sos$sanders_count\ndem_results_sos$total <- dem_results_sos$clinton_count + dem_results_sos$sanders_count + dem_results_sos$others_count\ndem_results_sos$clinton_per <- round(dem_results_sos$clinton_count/dem_results_sos$total*100,1)\ndem_results_sos$sanders_per <- round(dem_results_sos$sanders_count/dem_results_sos$total*100,1)\ndem_results_sos$others_per <- round(dem_results_sos$others_count/dem_results_sos$total*100,1)\ndem_results_sos$percent_diff <- dem_results_sos$clinton_per - dem_results_sos$sanders_per\n\nnames(dem_results_sos)[names(dem_results_sos) == 'Town.Name'] <- 'Town'\ndem_results <- dem_results_sos\n\n\nclinton <- dem_results[c(\"Town\", \"clinton_count\", \"sanders_count\")]\ntrump <- rep_results[c(\"Town\", \"trump_count\", \"total\")]\n\nclinton_trump <- left_join(clinton, trump)\nclinton_trump$ct <- ifelse(clinton_trump$trump_count > clinton_trump$clinton_count, \"trump\", \"clinton\")\n```\n\n```{r map, fig.width=9, fig.height=6}\n\ntown_shape <- readOGR(dsn=\"maps\", layer=\"ctgeo\")\ntown_shape_df <- fortify(town_shape, region=\"NAME10\")\n\ntown_map <- clinton_trump\ntown_map <- town_map[c(\"Town\",  \"trump_count\", \"clinton_count\", \"ct\")]\n\ncolnames(town_map) <- c(\"id\", \"Clinton\", \"Trump\", \"Winner\")\ntown_map$Winner <- gsub(\"trump\", \"Trump\", town_map$Winner)\ntown_map$Winner <- gsub(\"clinton\", \"Clinton\", town_map$Winner)\n\nvoters_map <- left_join(town_shape_df, town_map)\n\n\n\n# plot map\ngg <- ggplot(voters_map, aes(long,lat, group=group, fill=Winner)) + \n  geom_polygon() + \n  geom_path(color = \"white\") +\n  coord_equal() \ngg <- gg + labs(x=NULL, y=NULL, title=\"Trump versus Clinton votes in the primaries\",\n                subtitle=\"Based on raw primary votes, Trump would have won 99 towns in Connecticut while Clinton would have won just 70.\",\n                caption=\"SOURCE: Office of the Secretary of State\\nAndrew Ba Tran/TrendCT.org\")\ngg <- gg + theme_bw(base_family=\"Calibri\")\ngg <- gg + theme(text = element_text(size=16))\ngg <- gg + theme(panel.grid.major=element_blank())\ngg <- gg + theme(panel.grid.minor=element_blank())\ngg <- gg + theme(panel.border=element_blank())\ngg <- gg + theme(axis.ticks=element_blank())\ngg <- gg + theme(axis.text.x=element_blank())\ngg <- gg + theme(axis.text.y=element_blank())\n\ngg <- gg + theme(plot.title=element_text(face=\"bold\", family=\"Lato Black\", size=22))\ngg <- gg + theme(plot.subtitle=element_text(face=\"italic\", size=9, margin=margin(b=12)))\ngg <- gg + theme(plot.caption=element_text(size=12, margin=margin(t=10, r=80), color=\"#7a7d7e\"))\ngg <- gg + theme(plot.margin = unit(c(1, 1, 1, 1), \"lines\"))\n\ngg\n```\n\nBut those towns are the most-populous ones because Clinton received 170,000 votes in the Democratic primary— almost 50,000 more than Trump.\n\nSo based on primary votes, what would it take for Trump to beat Clinton?\n\nA couple things: If all Republican primary voters (213,000) voted for Trump or if all voters who chose Bernie Sanders picked Trump, his votes would be boosted to 276,000. \n\n\n```{r map_test1, fig.width=9, fig.height=6}\n\ntown_map <- clinton_trump\ntown_map$ct <- ifelse(town_map$total > town_map$clinton_count, \"Trump\", \"Clinton\")\n\ntown_map <- town_map[c(\"Town\",  \"trump_count\", \"clinton_count\", \"ct\")]\n\ncolnames(town_map) <- c(\"id\", \"Clinton\", \"Trump\", \"Winner\")\ntown_map$Winner <- gsub(\"trump\", \"Trump\", town_map$Winner)\ntown_map$Winner <- gsub(\"clinton\", \"Clinton\", town_map$Winner)\n\nvoters_map <- left_join(town_shape_df, town_map)\n\n\n\n# plot map\ngg <- ggplot(voters_map, aes(long,lat, group=group, fill=Winner)) + \n  geom_polygon() + \n  geom_path(color = \"white\") +\n  coord_equal() \ngg <- gg + labs(x=NULL, y=NULL, title=\"Republican votes compared to Clinton votes in the primaries\",\n                subtitle=\"If all participating registered Republicans voted for Trump in the primaries.\",\n                caption=\"SOURCE: Office of the Secretary of State\\nAndrew Ba Tran/TrendCT.org\")\ngg <- gg + theme_bw(base_family=\"Calibri\")\ngg <- gg + theme(text = element_text(size=16))\ngg <- gg + theme(panel.grid.major=element_blank())\ngg <- gg + theme(panel.grid.minor=element_blank())\ngg <- gg + theme(panel.border=element_blank())\ngg <- gg + theme(axis.ticks=element_blank())\ngg <- gg + theme(axis.text.x=element_blank())\ngg <- gg + theme(axis.text.y=element_blank())\n\ngg <- gg + theme(plot.title=element_text(face=\"bold\", family=\"Lato Black\", size=22))\ngg <- gg + theme(plot.subtitle=element_text(face=\"italic\", size=9, margin=margin(b=12)))\ngg <- gg + theme(plot.caption=element_text(size=12, margin=margin(t=10, r=80), color=\"#7a7d7e\"))\ngg <- gg + theme(plot.margin = unit(c(1, 1, 1, 1), \"lines\"))\n\ngg\n\n```\n\n\n\n```{r map_test2, fig.width=9, fig.height=6}\n\n\ntown_map <- clinton_trump\ntown_map$total <- town_map$sanders_count + town_map$trump_count\ntown_map$ct <- ifelse(town_map$total > town_map$clinton_count, \"Trump\", \"Clinton\")\n\ntown_map <- town_map[c(\"Town\",  \"trump_count\", \"clinton_count\", \"ct\")]\n\ncolnames(town_map) <- c(\"id\", \"Clinton\", \"Trump\", \"Winner\")\ntown_map$Winner <- gsub(\"trump\", \"Trump\", town_map$Winner)\ntown_map$Winner <- gsub(\"clinton\", \"Clinton\", town_map$Winner)\n\nvoters_map <- left_join(town_shape_df, town_map)\n\n\n\n# plot map\ngg <- ggplot(voters_map, aes(long,lat, group=group, fill=Winner)) + \n  geom_polygon() + \n  geom_path(color = \"white\") +\n  coord_equal() \ngg <- gg + labs(x=NULL, y=NULL, title=\"Trump (and Sanders) versus Clinton votes in the primaries\",\n                subtitle=\"If all Bernie Sanders voters switched to Trump\",\n                caption=\"SOURCE: Office of the Secretary of State\\nAndrew Ba Tran/TrendCT.org\")\ngg <- gg + theme_bw(base_family=\"Calibri\")\ngg <- gg + theme(text = element_text(size=16))\ngg <- gg + theme(panel.grid.major=element_blank())\ngg <- gg + theme(panel.grid.minor=element_blank())\ngg <- gg + theme(panel.border=element_blank())\ngg <- gg + theme(axis.ticks=element_blank())\ngg <- gg + theme(axis.text.x=element_blank())\ngg <- gg + theme(axis.text.y=element_blank())\n\ngg <- gg + theme(plot.title=element_text(face=\"bold\", family=\"Lato Black\", size=22))\ngg <- gg + theme(plot.subtitle=element_text(face=\"italic\", size=9, margin=margin(b=12)))\ngg <- gg + theme(plot.caption=element_text(size=12, margin=margin(t=10, r=80), color=\"#7a7d7e\"))\ngg <- gg + theme(plot.margin = unit(c(1, 1, 1, 1), \"lines\"))\n\ngg\n```\n\n## If unaffiliated voters went to Trump\n\nBut that would never be the case. \n\nPlus, primary election participation pales in comparison to general election participation.\n\nAbout 1.6 million votes were cast in Connecticut during the presidential election between Barack Obama and John McCain. That's nearly 3 times the number of votes in this previous primary election.\n\nAlso, primaries in Connecticut are limited to those registered to parties, which excludes a huge number of voters.\n\nThere are about 803,000 voters registered as unaffiliated. \n\nThat's more than the 730,000 registered as Democrats and 426,000 registered as Republicans.\n\nIf Trump could reach those large numbers of unaffiliated voters to make up for the Democrats outnumbering the Republicans in Connecticut, he's got a shot. Just 38 percent of the unaffiliated voters would make up the the difference between the number of registered Democrats and Republicans.\n\n```{r calculating_registered}\nregis <- read.csv(\"data/ACT_VOTER_TOWN_PRTY_072116.csv\")\n\nregis_percent <- regis %>%\n  group_by(Town) %>%\n  mutate(Percent=round(Registered/sum(Registered)*100, 2))\n\nregis_percent_un <- regis_percent %>%\n  filter(Party==\"Unaffiliated\")\n```\n\n```{r unaffiliated_map, fig.width=9, fig.height=6}\n\n\ntown_map <- regis_percent_un\n\ncolnames(town_map) <- c(\"id\",  \"party\", \"Total\", \"Percent\")\n\nvoters_map <- left_join(town_shape_df, town_map)\n\n\ngg <- ggplot() +\n  geom_polygon(data = voters_map, aes(x=long, y=lat, group=group, fill=Percent), color = \"black\", size=0.2) +\n  coord_map() +\n  scale_fill_distiller(type=\"seq\", trans=\"reverse\", palette = \"Purple\", breaks=pretty_breaks(n=10))\ngg <- gg + labs(x=NULL, y=NULL, title=\"Where the unaffiliated voters are\",\n                subtitle=\"As of July 21, 2016.\",\n                caption=\"SOURCE: Office of the Secretary of State\\nAndrew Ba Tran/TrendCT.org\")\ngg <- gg + theme_bw(base_family=\"Calibri\")\ngg <- gg + theme(text = element_text(size=16))\ngg <- gg + theme(panel.grid.major=element_blank())\ngg <- gg + theme(panel.grid.minor=element_blank())\ngg <- gg + theme(panel.border=element_blank())\ngg <- gg + theme(axis.ticks=element_blank())\ngg <- gg + theme(axis.text.x=element_blank())\ngg <- gg + theme(axis.text.y=element_blank())\n\ngg <- gg + theme(plot.title=element_text(face=\"bold\", family=\"Lato Black\", size=22))\ngg <- gg + theme(plot.subtitle=element_text(face=\"italic\", size=9, margin=margin(b=12)))\ngg <- gg + theme(plot.caption=element_text(size=12, margin=margin(t=10, r=80), color=\"#7a7d7e\"))\ngg <- gg + theme(plot.margin = unit(c(1, 1, 1, 1), \"lines\"))\n\ngg\n\n```\n\n\n```{r census_analysis}\nsource(\"keys.R\")\n#install.packages(\"devtools\")\n#devtools::install_github(\"hrecht/censusapi\")\nlibrary(\"censusapi\")\n\n\n\n# apis <- listCensusApis()\n# View(apis)\n# geos2014 <- listCensusMetadata(name=\"acs5\", vintage=2014, \"g\")\n# View(geos2014)\n# # tracts = 140\n# vars2014 <- listCensusMetadata(name=\"acs5\", vintage=2014, \"v\")\n# View(vars2014)\n\ngeos2014 <- listCensusMetadata(name=\"acs5\", vintage=2014, \"g\")\nView(geos2014)\n#B23025\n#B23025. Employment Status for the Population 16 Years and Over\n#B23025_001E Total\n#B23025_002E In labor force\n#B23025_005E In labor force:!!Civilian labor force:!!Unemployed\n\nunemployment_towns <- getCensus(name=\"acs5\",\n    vintage=2014,\n    key=census_key,\n    vars=c(\"NAME\", \"B23025_001E\", \"B23025_002E\", \"B23025_005E\" ),\n    region=\"county subdivision:*\", regionin=\"state:09\")\n\n\n# race_tracts <- getCensus(name=\"acs5\", \n#     vintage=2014,\n#     key=census_key, \n#     vars=c(\"NAME\", \"B02001_001E\", \"B02001_002E\", \"B02001_003E\", \"B03001_001E\"), \n#     region=\"tract:*\", regionin=\"state:09\")\n# \n\n```\n[Scatterplot of unemployment percent to percent of unaffiliated voters]\n[Scatterplot of unemployment percent to Clinton win percent?]\n\nIn towns with high unemployment rates, ....\nIn towns with low minority population...\n\n## Based on polling...\n\nAccording to the latest Quinnipiac poll, Clinton is leading Trump but only by a single digit. That's smaller than expected for a state like Connecticut, according to researchers. Plus, her negative favorability rating is almost at the same level as Trump's.\n\n[TABLE]\n\n**Thought exercise: Let's take these numbers at face value and apply them to registered voters and assume that all who have registered will vote**\n\nIf we take the 9 percent of Republicans polled who said they would vote for Clinton and applied that to the number of registered Republican voters, that would be about 38,000 voters. Plus 85 percent of registered Democrats as well as 36 percent of unregistered equals; Clinton would have more than 950,000 votes.\n\nTrump, meanwhile, would end up with just 702,000 if we assume 79 percent of registered Republicans, 5 percent of democrats, and 41 percent of independents voted for him.\n\nEven with Libertarian candidate Gary Johnson and Green party candidate Jill Stein in the mix, Clinton would still theoretically have 870,000 votes to Trump's 670,000. \n\n## If women stayed home\n\nTrump has support from more men than women—— 55 percent compared to 35 percent. \n\nSo if female voters were excluded from the voting population, Trump could be elcted.\n\n## If minorities did not vote\n\nClinton has an overwhelming 70 percent support rate according to the poll. \n\nAmong whites who were polled, 44 percent were for Trump, ahead of 39 percent for Clinton.\n\n## Especially if Hispanics did not vote\n\nConnecticut ranks 10th among states of eligible Hispanic voters at 10.8 percent of the population. It's one of 16 states where more than half of the Hispanic population is eligble to vote.\n\nThe Republican nominee for President has alienated many Hispanic voters with promises to build a wall along the southern border and attacking a judge with Mexican heritage.\n\nAccording to a recent poll from the [Latino Victory Fund/Latino Decisions/Fusion](http://thehill.com/blogs/ballot-box/presidential-races/288413-poll-most-hispanics-see-trump-unfavorably) poll, 79 percent of Hispanic voters view Trump negatively.\n\nHowever, minorities only make up less than 20 percent of the state population.\n\nWill there be enough white voters choosing Trump to make up for the minorities who will vote for Clinton?\n\n## If he has a time machine\n\nConnecticut had a streak of voting for Republican candidates for President starting in 1972 through 1988, with the election of George Bush and Dan Quayle. \n\nThen in 1992, Connecticut flipped to a Clinton, Bill. The state has voted for a Democratic presidential candidate each general election since.\n\n[CHART TIMELINE OR TABLE]\n\n## If part of the state collapses into the ocean\n\nThese are the towns that voted for John McCain and Sarah Palin in 2008.\n\nIf they remained and the towns that voted for President Obama disappeared, then Trump definitely has a strong chance to win.\n\n\n```{r 2008_data}\np2008 <- read.csv(\"data/2008presidential.csv\")\np2008$winner <- ifelse(p2008$McCain.Palin > p2008$Obama.Biden, \"McCain and Palin\", \"Obama and Biden\")\n\n```\n\n```{r 2008_results, fig.width=9, fig.height=6}\n\np2008 <- subset(p2008, winner==\"McCain and Palin\")\n\ntown_map <- p2008\ntown_map <- town_map[c(\"Town\", \"McCain.Palin\", \"winner\")]\ncolnames(town_map) <- c(\"id\", \"McCain.Palin\", \"Winner\")\n\nvoters_map <- left_join(town_shape_df, town_map)\nvoters_map <- subset(voters_map, !is.na(Winner))\n\n\n# plot map\ngg <- ggplot(voters_map, aes(long,lat, group=group, fill=Winner)) + \n  geom_polygon() + \n  geom_path(color = \"white\") +\n  coord_equal() \ngg <- gg + labs(x=NULL, y=NULL, title=\"Towns where McCain and Palin won in 2008\",\n                subtitle=\"During the Presidential general election.\",\n                caption=\"SOURCE: Office of the Secretary of State\\nAndrew Ba Tran/TrendCT.org\")\ngg <- gg + theme_bw(base_family=\"Calibri\")\ngg <- gg + theme(panel.background = element_rect(fill = \"Sky Blue\"))\n\ngg <- gg + theme(text = element_text(size=16))\ngg <- gg + theme(panel.grid.major=element_blank())\ngg <- gg + theme(panel.grid.minor=element_blank())\ngg <- gg + theme(panel.border=element_blank())\ngg <- gg + theme(axis.ticks=element_blank())\ngg <- gg + theme(axis.text.x=element_blank())\ngg <- gg + theme(axis.text.y=element_blank())\n\ngg <- gg + theme(plot.title=element_text(face=\"bold\", family=\"Lato Black\", size=22))\ngg <- gg + theme(plot.subtitle=element_text(face=\"italic\", size=9, margin=margin(b=12)))\ngg <- gg + theme(plot.caption=element_text(size=12, margin=margin(t=10, r=80), color=\"#7a7d7e\"))\ngg <- gg + theme(plot.margin = unit(c(1, 1, 1, 1), \"lines\"))\n\ngg\n\n```",
    "created" : 1469124334747.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1622005079",
    "id" : "45C4DBDC",
    "lastKnownWriteTime" : 1469459013,
    "last_content_update" : 1469459013591,
    "path" : "~/Documents/Github/data/2016/07/trump_ct/index.Rmd",
    "project_path" : "index.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}